"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[961],{9961:(v,h,r)=>{r.r(h),r.d(h,{default:()=>k});var p=r(177),g=r(2389),t=r(3953),u=r(2525),f=r(1626);let m=(()=>{class i{constructor(e){this.http=e,this.apiUrl=`${u.c.apiUrl}/api`,this.db=localStorage.getItem("devID")||""}getDisposeHistory(){return this.http.get(`${this.apiUrl}/getDisposeHistory?db=${this.db}`)}static#t=this.\u0275fac=function(n){return new(n||i)(t.KVO(f.Qq))};static#e=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var _=r(3525),c=r(4341),b=r(3413);const C=["notesModal"];function y(i,l){1&i&&(t.j41(0,"div",16)(1,"div",17)(2,"p"),t.EFF(3,"Loading..."),t.k0s()()())}function x(i,l){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td")(12,"button",22),t.bIt("click",function(){const s=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.viewDisposeDetails(s))}),t.nrm(13,"i",23),t.k0s()()()}if(2&i){const e=l.$implicit,n=t.XpG(2);t.R7$(2),t.JRh(n.formatDate(e.disdate)),t.R7$(2),t.JRh(e.disitemcode),t.R7$(2),t.JRh(e.disitemdesc),t.R7$(2),t.JRh(e.disqty),t.R7$(2),t.JRh(e.disremarks)}}function P(i,l){if(1&i&&(t.j41(0,"div",18)(1,"table",19)(2,"thead")(3,"tr",20)(4,"th"),t.EFF(5,"Date"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Item Code"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Description"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Quantity"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Remarks"),t.k0s(),t.nrm(14,"th"),t.k0s()(),t.j41(15,"tbody"),t.DNE(16,x,14,5,"tr",21),t.k0s()()()),2&i){const e=t.XpG();t.R7$(16),t.Y8G("ngForOf",e.displayeddispose)}}function D(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",24)(1,"button",25),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.goToPage(s.currentPage-1))}),t.EFF(2," Previous "),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"button",25),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.goToPage(s.currentPage+1))}),t.EFF(6," Next "),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("disabled",1===e.currentPage),t.R7$(3),t.Lme("Page ",e.currentPage," of ",e.totalPages,""),t.R7$(),t.Y8G("disabled",e.currentPage===e.totalPages)}}function M(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",26)(1,"div",27)(2,"h4",28),t.EFF(3,"Notes"),t.k0s(),t.j41(4,"button",29),t.bIt("click",function(){const s=t.eBV(e).$implicit;return t.Njj(s.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",30),t.nrm(6,"div",31),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("innerHTML",null==e.selectedDispose?null:e.selectedDispose.DisposeNote,t.npT)}}let k=(()=>{class i{constructor(e,n,s){this.disposeService=e,this.datePipe=n,this.modalService=s,this.disposes=[],this.displayeddispose=[],this.filtereddispose=[],this.loading=!1,this.currentPage=1,this.pageSize=10,this.totalPages=1,this.searchTerm="",this.searchCriteria="disitemcode",this.disposeStatus=[],this.modalRef=null}formatDate(e){return this.datePipe.transform(e,"yyyy-MM-dd")||""}ngOnInit(){this.loaddispose()}loaddispose(){this.loading=!0,this.disposeService.getDisposeHistory().subscribe(e=>{this.disposes=e,this.applyStatusFilter(),this.totalPages=Math.ceil(this.filtereddispose.length/this.pageSize),this.updateDisplayeddispose(),this.loading=!1},e=>{this.loading=!1,console.error("Error fetching dispose",e)})}updateDisplayeddispose(){const e=(this.currentPage-1)*this.pageSize;this.displayeddispose=this.filtereddispose.slice(e,e+this.pageSize)}goToPage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,this.updateDisplayeddispose())}search(){this.filtereddispose=this.disposes.filter(e=>e[this.searchCriteria]?.toLowerCase().includes(this.searchTerm.toLowerCase())),this.totalPages=Math.ceil(this.filtereddispose.length/this.pageSize),this.currentPage=1,this.updateDisplayeddispose()}filterDisposeStatus(e){this.disposeStatus=e,this.searchTerm="",this.applyStatusFilter()}applyStatusFilter(){this.filtereddispose=this.disposeStatus&&this.disposeStatus.length>0?this.disposes.filter(e=>this.disposeStatus.includes(e.disremarks)):this.disposes,this.totalPages=Math.ceil(this.filtereddispose.length/this.pageSize),this.currentPage=1,this.updateDisplayeddispose()}viewDisposeDetails(e){this.selectedDispose=e,this.modalRef=this.modalService.open(this.notesModal,{centered:!0}),this.modalRef.result.finally(()=>null)}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(m),t.rXU(p.vh),t.rXU(_.Bq))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-dispose-history"]],viewQuery:function(n,s){if(1&n&&t.GBs(C,5),2&n){let o;t.mGM(o=t.lsd())&&(s.notesModal=o.first)}},standalone:!0,features:[t.Jv_([p.vh]),t.aNF],decls:22,vars:6,consts:[["notesModal",""],[1,"col-xl-12"],["cardTitle","Disposed Items","blockClass","table-border-style",3,"options"],[1,"search-container"],["type","text","placeholder","Search ...",1,"form-control","search-input",3,"ngModelChange","input","ngModel"],[1,"form-control","search-criteria",3,"ngModelChange","change","ngModel"],["value","disitemcode"],["value","disitemdesc"],[1,"card-header"],[1,"header-title"],[1,"button-group"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"],["class","loading-overlay",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"table-responsive"],[1,"table","table-styling"],[1,"table-primary"],[4,"ngFor","ngForOf"],[1,"btn","btn-link",3,"click"],[1,"far","fa-sticky-note"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-dark",3,"click","disabled"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"rich-text-box",3,"innerHTML"]],template:function(n,s){if(1&n){const o=t.RV6();t.j41(0,"div",1)(1,"app-card",2)(2,"div",3)(3,"input",4),t.mxI("ngModelChange",function(a){return t.eBV(o),t.DH7(s.searchTerm,a)||(s.searchTerm=a),t.Njj(a)}),t.bIt("input",function(){return t.eBV(o),t.Njj(s.search())}),t.k0s(),t.j41(4,"select",5),t.mxI("ngModelChange",function(a){return t.eBV(o),t.DH7(s.searchCriteria,a)||(s.searchCriteria=a),t.Njj(a)}),t.bIt("change",function(){return t.eBV(o),t.Njj(s.search())}),t.j41(5,"option",6),t.EFF(6,"Item Code"),t.k0s(),t.j41(7,"option",7),t.EFF(8,"Description"),t.k0s()()(),t.j41(9,"div",8)(10,"div",9),t.nrm(11,"h5"),t.k0s(),t.j41(12,"div",10)(13,"button",11),t.bIt("click",function(){return t.eBV(o),t.Njj(s.filterDisposeStatus(["DISPOSED"]))}),t.EFF(14,"DISPOSED"),t.k0s(),t.j41(15,"button",12),t.bIt("click",function(){return t.eBV(o),t.Njj(s.filterDisposeStatus(["JUNKED","REPLACED"]))}),t.EFF(16,"JUNKED/REPLACED"),t.k0s()()(),t.DNE(17,y,4,0,"div",13)(18,P,17,1,"div",14)(19,D,7,4,"div",15),t.k0s()(),t.DNE(20,M,7,1,"ng-template",null,0,t.C5r)}2&n&&(t.R7$(),t.Y8G("options",!1),t.R7$(2),t.R50("ngModel",s.searchTerm),t.R7$(),t.R50("ngModel",s.searchCriteria),t.R7$(13),t.Y8G("ngIf",s.loading),t.R7$(),t.Y8G("ngIf",!s.loading),t.R7$(),t.Y8G("ngIf",!s.loading&&s.displayeddispose.length>0))},dependencies:[g.G,p.Sq,p.bT,c.xH,c.y7,c.me,c.wz,c.BC,c.vS,b.i],styles:[".search-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s;margin-right:10px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.search-container[_ngcontent-%COMP%]   .search-criteria[_ngcontent-%COMP%]{width:150px;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s}.search-container[_ngcontent-%COMP%]   .search-criteria[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#333}.loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:5px;border-bottom:1px solid #dee2e6}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}.rich-text-box[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;border-radius:5px;background-color:#f9f9f9;max-height:400px;overflow-y:auto;font-size:14px}.rich-text-box[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .rich-text-box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .rich-text-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:700;color:#333}.rich-text-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px}.rich-text-box[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.rich-text-box[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.rich-text-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .rich-text-box[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{padding-left:20px}.rich-text-box[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px}.rich-text-box[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{border-left:3px solid #ccc;padding-left:10px;margin:10px 0;font-style:italic}"]})}return i})()}}]);