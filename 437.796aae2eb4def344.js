"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[437],{7437:(D,h,o)=>{o.r(h),o.d(h,{default:()=>v});var m=o(177),p=o(2389),t=o(3953),u=o(7272),_=o(3525),d=o(4341),f=o(3413);const g=["transferCartModal"];function I(r,a){1&r&&(t.j41(0,"div",12)(1,"div",13)(2,"p"),t.EFF(3,"Loading..."),t.k0s()()())}function F(r,a){if(1&r){const e=t.RV6();t.j41(0,"div",14)(1,"div",15)(2,"label",16),t.EFF(3,"Start Date:"),t.k0s(),t.j41(4,"input",17),t.mxI("ngModelChange",function(s){t.eBV(e);const i=t.XpG();return t.DH7(i.startDate,s)||(i.startDate=s),t.Njj(s)}),t.bIt("change",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.searchtransferItems())}),t.k0s()(),t.j41(5,"div",15)(6,"label",18),t.EFF(7,"End Date:"),t.k0s(),t.j41(8,"input",19),t.mxI("ngModelChange",function(s){t.eBV(e);const i=t.XpG();return t.DH7(i.endDate,s)||(i.endDate=s),t.Njj(s)}),t.bIt("change",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.searchtransferItems())}),t.k0s()(),t.j41(9,"div",20)(10,"button",21),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.showAlltransferItems())}),t.EFF(11,"Show All"),t.k0s()()()}if(2&r){const e=t.XpG();t.R7$(4),t.R50("ngModel",e.startDate),t.R7$(4),t.R50("ngModel",e.endDate)}}function E(r,a){1&r&&(t.j41(0,"div",12)(1,"div",13)(2,"p"),t.EFF(3,"Loading..."),t.k0s()()())}function b(r,a){1&r&&(t.j41(0,"tr")(1,"td",27),t.EFF(2,"No Transfer Items available"),t.k0s()())}function P(r,a){if(1&r){const e=t.RV6();t.j41(0,"tr",28),t.bIt("click",function(){const s=t.eBV(e),i=s.$implicit,c=s.index,l=t.XpG(2);return t.Njj(l.openDetailsModal(i,c))}),t.j41(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"currency"),t.k0s()()}if(2&r){const e=a.$implicit,n=a.index,s=t.XpG(2);t.AVh("selected",n===s.clickedRowIndex),t.R7$(2),t.JRh(e.poutrefnum),t.R7$(2),t.JRh(e.pullsupplier),t.R7$(2),t.JRh(e.pouttype),t.R7$(2),t.JRh(e.pouttotalqty),t.R7$(2),t.JRh(e.poutencoder),t.R7$(2),t.JRh(s.formatDate(e.pulldate)),t.R7$(2),t.JRh(t.i5U(15,9,e.restockprice,"PHP"))}}function k(r,a){if(1&r&&(t.j41(0,"div",22)(1,"table",23)(2,"thead")(3,"tr",24)(4,"th"),t.EFF(5,"Transfer Order No."),t.k0s(),t.j41(6,"th"),t.EFF(7,"Supplier"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Category"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Total Items"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Encoder"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Date Created"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Purchase Price"),t.k0s()()(),t.j41(18,"tbody"),t.DNE(19,b,3,0,"tr",25)(20,P,16,12,"tr",26),t.k0s()()()),2&r){const e=t.XpG();t.R7$(19),t.Y8G("ngIf",0===e.displayedtransferItems.length),t.R7$(),t.Y8G("ngForOf",e.displayedtransferItems)}}function j(r,a){if(1&r){const e=t.RV6();t.j41(0,"div",29)(1,"button",30),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.goToPage(s.currentPage-1))}),t.EFF(2,"Previous"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"button",30),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.goToPage(s.currentPage+1))}),t.EFF(6,"Next"),t.k0s()()}if(2&r){const e=t.XpG();t.R7$(),t.Y8G("disabled",1===e.currentPage),t.R7$(3),t.Lme("Page ",e.currentPage," of ",e.totalPages,""),t.R7$(),t.Y8G("disabled",e.currentPage===e.totalPages)}}function C(r,a){1&r&&(t.j41(0,"tr")(1,"td",43),t.EFF(2,"No Fill Items"),t.k0s()())}function y(r,a){if(1&r&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s()()),2&r){const e=a.$implicit;t.R7$(2),t.JRh(e.poutitemcode),t.R7$(2),t.JRh(e.poutitemname),t.R7$(2),t.JRh(e.poutqty)}}function R(r,a){1&r&&(t.j41(0,"tr")(1,"td",43),t.EFF(2,"No Empty Items"),t.k0s()())}function T(r,a){if(1&r&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s()()),2&r){const e=a.$implicit;t.R7$(2),t.JRh(e.poutitemcode),t.R7$(2),t.JRh(e.poutitemname),t.R7$(2),t.JRh(e.poutqty)}}function M(r,a){if(1&r){const e=t.RV6();t.j41(0,"div",31)(1,"div",32)(2,"h4",33),t.EFF(3,"Details"),t.k0s(),t.j41(4,"button",34),t.bIt("click",function(){const s=t.eBV(e).$implicit;return t.Njj(s.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",35)(6,"div",36)(7,"div",37)(8,"strong"),t.EFF(9,"Transfer Order No. :"),t.k0s()(),t.j41(10,"div",37),t.EFF(11),t.k0s(),t.j41(12,"div",37)(13,"strong"),t.EFF(14,"Encoder :"),t.k0s()(),t.j41(15,"div",37),t.EFF(16),t.k0s()(),t.j41(17,"div",36)(18,"div",37)(19,"strong"),t.EFF(20,"Supplier :"),t.k0s()(),t.j41(21,"div",37),t.EFF(22),t.k0s(),t.j41(23,"div",37)(24,"strong"),t.EFF(25,"Date :"),t.k0s()(),t.j41(26,"div",37),t.EFF(27),t.k0s()(),t.j41(28,"div",38)(29,"div",39)(30,"div",22)(31,"h6"),t.EFF(32),t.k0s(),t.j41(33,"table",23)(34,"thead")(35,"tr",24)(36,"th"),t.EFF(37,"Itemcode"),t.k0s(),t.j41(38,"th"),t.EFF(39,"Description"),t.k0s(),t.j41(40,"th"),t.EFF(41,"Quantity"),t.k0s()()(),t.j41(42,"tbody"),t.DNE(43,C,3,0,"tr",25)(44,y,7,3,"tr",40),t.k0s(),t.j41(45,"tfoot")(46,"tr",24)(47,"td",41)(48,"strong"),t.EFF(49,"Total Quantity:"),t.k0s()(),t.j41(50,"td"),t.EFF(51),t.k0s()()()()()(),t.j41(52,"div",39)(53,"div",22)(54,"h6"),t.EFF(55),t.k0s(),t.j41(56,"table",23)(57,"thead")(58,"tr",24)(59,"th"),t.EFF(60,"Itemcode"),t.k0s(),t.j41(61,"th"),t.EFF(62,"Description"),t.k0s(),t.j41(63,"th"),t.EFF(64,"Quantity"),t.k0s()()(),t.j41(65,"tbody"),t.DNE(66,R,3,0,"tr",25)(67,T,7,3,"tr",40),t.k0s(),t.j41(68,"tfoot")(69,"tr",24)(70,"td",41)(71,"strong"),t.EFF(72,"Total Quantity:"),t.k0s()(),t.j41(73,"td"),t.EFF(74),t.k0s()()()()()()(),t.j41(75,"div",38)(76,"div",42)(77,"div")(78,"strong"),t.EFF(79,"Status:"),t.k0s(),t.EFF(80),t.k0s(),t.j41(81,"div")(82,"strong"),t.EFF(83,"PRICE:"),t.k0s(),t.EFF(84),t.nI1(85,"currency"),t.k0s(),t.j41(86,"div")(87,"strong"),t.EFF(88,"Total Items:"),t.k0s(),t.EFF(89),t.k0s()()()()()}if(2&r){const e=t.XpG();t.R7$(11),t.SpI(" ",null==e.selectedItem?null:e.selectedItem.poutrefnum," "),t.R7$(5),t.SpI(" ",null==e.selectedItem?null:e.selectedItem.poutencoder," "),t.R7$(6),t.SpI(" ",null==e.selectedItem?null:e.selectedItem.pullsupplier," "),t.R7$(5),t.SpI(" ",null==e.selectedItem?null:e.selectedItem.pulldate," "),t.R7$(5),t.JRh(e.Fillitemlabel),t.R7$(11),t.Y8G("ngIf",0===e.fillitems.length),t.R7$(),t.Y8G("ngForOf",e.fillitems),t.R7$(7),t.JRh(e.getTotalFillQty()),t.R7$(4),t.JRh(e.EmptyItemlabel),t.R7$(11),t.Y8G("ngIf",0===e.emptyitems.length),t.R7$(),t.Y8G("ngForOf",e.emptyitems),t.R7$(7),t.JRh(e.getTotalEmptyQty()),t.R7$(6),t.SpI(" ",null==e.selectedItem?null:e.selectedItem.pulloutremarks," "),t.R7$(4),t.SpI(" ",t.brH(85,15,null==e.selectedItem?null:e.selectedItem.restockprice,"PHP",!0)," "),t.R7$(5),t.SpI(" ",null==e.selectedItem?null:e.selectedItem.pouttotalqty," ")}}let v=(()=>{class r{constructor(e,n,s){this.transferItemService=e,this.modalService=n,this.datePipe=s,this.transferItems=[],this.displayedtransferItems=[],this.filteredtransferItems=[],this.loading=!1,this.currentPage=1,this.pageSize=10,this.totalPages=1,this.searchTerm="",this.searchCriteria="poutrefnum",this.clickedRowIndex=null,this.selectedItem=null,this.modalRef=null,this.startDate="",this.endDate="",this.notransferItems=!1,this.fillitems=[],this.emptyitems=[],this.operator="",this.Fillitemlabel="Fill Items",this.EmptyItemlabel="Empty Items"}ngOnInit(){this.loadtransferItems().then(()=>{const e=new Date;this.startDate=this.formatDate(e),this.endDate=this.formatDate(e),this.searchtransferItems()})}formatDate(e){return this.datePipe.transform(e,"yyyy-MM-dd")||""}loadtransferItems(){return this.loading=!0,new Promise((e,n)=>{this.transferItemService.getPurchases().subscribe(s=>{this.transferItems=s,this.filteredtransferItems=this.transferItems.filter(i=>this.formatDate(i.pulldate)===this.formatDate(new Date)),this.totalPages=Math.ceil(this.filteredtransferItems.length/this.pageSize),this.notransferItems=0===this.filteredtransferItems.length,this.updateDisplayedtransferItems(),this.loading=!1,e()},s=>{this.loading=!1,this.notransferItems=!0,console.error("Error fetching transferItems",s),n(s)})})}updateDisplayedtransferItems(){const e=(this.currentPage-1)*this.pageSize;this.displayedtransferItems=this.filteredtransferItems.slice(e,e+this.pageSize)}goToPage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,this.updateDisplayedtransferItems())}searchtransferItems(){this.filteredtransferItems=this.transferItems.filter(e=>{const n=e[this.searchCriteria]?.toLowerCase().includes(this.searchTerm.toLowerCase()),s=!this.startDate||new Date(e.pulldate)>=new Date(this.startDate),i=!this.endDate||new Date(e.pulldate)<=new Date(this.endDate);return n&&s&&i}),this.totalPages=Math.ceil(this.filteredtransferItems.length/this.pageSize),this.currentPage=1,this.updateDisplayedtransferItems()}showAlltransferItems(){this.loading=!0,this.transferItemService.getPurchases().subscribe(e=>{this.transferItems=e,this.filteredtransferItems=this.transferItems,this.totalPages=Math.ceil(this.filteredtransferItems.length/this.pageSize),this.updateDisplayedtransferItems(),this.loading=!1,this.startDate="",this.endDate=""},e=>{this.loading=!1,console.error("Error fetching transferItems",e)})}openDetailsModal(e,n){switch(this.selectedItem=e,this.clickedRowIndex=n,this.selectedItem.pouttype){case"RESTOCK OUT":this.Fillitemlabel="EMPTY ITEMS(-)",this.EmptyItemlabel="FILL ITEMS(-)";break;case"RESTOCK IN":this.Fillitemlabel="FILL ITEMS(+)",this.EmptyItemlabel="EMPTY ITEMS(+)";break;case"CONVERT":this.Fillitemlabel="EMPTY ITEMS(+)",this.EmptyItemlabel="EMPTY ITEMS(-)";break;case"CREATE":this.Fillitemlabel="FILL ITEMS(+)",this.EmptyItemlabel="EMPTY ITEMS(-)";break;case"USED":this.Fillitemlabel="FILL ITEMS(-)",this.EmptyItemlabel="EMPTY ITEMS(+)";break;default:this.Fillitemlabel="",this.EmptyItemlabel=""}this.fetchFillCart(),this.fetchEmptyCart(),this.modalRef=this.modalService.open(this.transferCartModal,{centered:!0,size:"lg"}),this.modalRef.result.finally(()=>this.resetSelection())}resetSelection(){this.clickedRowIndex=null,this.selectedItem=null}fetchFillCart(){if(this.selectedItem){let e=this.selectedItem.pouttype+"FILL";"RESTOCK OUT"==this.selectedItem.pouttype&&(e=this.selectedItem.pouttype+"EMPTY"),this.transferItemService.getTransferCart(this.selectedItem.poutrefnum??"",e??"").subscribe(n=>{this.fillitems=n},n=>{console.error("Error fetching Fill items:",n)})}}getTotalFillQty(){return this.fillitems.reduce((e,n)=>e+n.poutqty,0)}fetchEmptyCart(){if(this.selectedItem){let e=this.selectedItem.pouttype+"EMPTY";"RESTOCK OUT"==this.selectedItem.pouttype&&(e=this.selectedItem.pouttype+"FILL"),this.transferItemService.getTransferCart(this.selectedItem.poutrefnum??"",e??"").subscribe(n=>{this.emptyitems=n},n=>{console.error("Error fetching EMPTY items:",n)})}}getTotalEmptyQty(){return this.emptyitems.reduce((e,n)=>e+n.poutqty,0)}static#t=this.\u0275fac=function(n){return new(n||r)(t.rXU(u.T),t.rXU(_.Bq),t.rXU(m.vh))};static#e=this.\u0275cmp=t.VBU({type:r,selectors:[["app-purchases"]],viewQuery:function(n,s){if(1&n&&t.GBs(g,5),2&n){let i;t.mGM(i=t.lsd())&&(s.transferCartModal=i.first)}},standalone:!0,features:[t.Jv_([m.vh]),t.aNF],decls:16,vars:8,consts:[["transferCartModal",""],[1,"col-xl-12"],["cardTitle","Purchase List","blockClass","table-border-style",3,"options"],["class","loading-overlay",4,"ngIf"],["class","row mb-3 align-items-end",4,"ngIf"],[1,"search-container"],["type","text","placeholder","Search ...",1,"form-control","search-input",3,"ngModelChange","input","ngModel"],[1,"form-control","search-criteria",3,"ngModelChange","change","ngModel"],["value","poutrefnum"],["value","pullsupplier"],["class","table-responsive",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"row","mb-3","align-items-end"],[1,"col-12","col-md-4"],["for","startDate",1,"form-label"],["type","date","id","startDate",1,"form-control",3,"ngModelChange","change","ngModel"],["for","endDate",1,"form-label"],["type","date","id","endDate",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-12","col-md-4","text-end"],[1,"btn","btn-secondary","mt-3","mt-md-0",3,"click"],[1,"table-responsive"],[1,"table","table-styling"],[1,"table-primary"],[4,"ngIf"],[3,"selected","click",4,"ngFor","ngForOf"],["colspan","11",1,"text-center"],[3,"click"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-dark",3,"click","disabled"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","mb-1"],[1,"col-6","col-md-3"],[1,"row","mt-4"],[1,"col-md-6"],[4,"ngFor","ngForOf"],["colspan","2",1,"text-end"],[1,"col-md-12","d-flex","justify-content-between"],["colspan","3",1,"text-center"]],template:function(n,s){if(1&n){const i=t.RV6();t.j41(0,"div",1)(1,"app-card",2),t.DNE(2,I,4,0,"div",3)(3,F,12,2,"div",4),t.j41(4,"div",5)(5,"input",6),t.mxI("ngModelChange",function(l){return t.eBV(i),t.DH7(s.searchTerm,l)||(s.searchTerm=l),t.Njj(l)}),t.bIt("input",function(){return t.eBV(i),t.Njj(s.searchtransferItems())}),t.k0s(),t.j41(6,"select",7),t.mxI("ngModelChange",function(l){return t.eBV(i),t.DH7(s.searchCriteria,l)||(s.searchCriteria=l),t.Njj(l)}),t.bIt("change",function(){return t.eBV(i),t.Njj(s.searchtransferItems())}),t.j41(7,"option",8),t.EFF(8,"Transfer Order No."),t.k0s(),t.j41(9,"option",9),t.EFF(10,"Supplier"),t.k0s()()(),t.DNE(11,E,4,0,"div",3)(12,k,21,2,"div",10)(13,j,7,4,"div",11),t.k0s()(),t.DNE(14,M,90,19,"ng-template",null,0,t.C5r)}2&n&&(t.R7$(),t.Y8G("options",!1),t.R7$(),t.Y8G("ngIf",s.loading),t.R7$(),t.Y8G("ngIf",!s.loading),t.R7$(2),t.R50("ngModel",s.searchTerm),t.R7$(),t.R50("ngModel",s.searchCriteria),t.R7$(5),t.Y8G("ngIf",s.loading),t.R7$(),t.Y8G("ngIf",!s.loading),t.R7$(),t.Y8G("ngIf",!s.loading&&s.displayedtransferItems.length>0))},dependencies:[p.G,m.Sq,m.bT,d.xH,d.y7,d.me,d.wz,d.BC,d.vS,f.i,m.oe],styles:[".search-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.search-input[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s;margin-right:10px}.search-input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.search-criteria[_ngcontent-%COMP%]{padding:10px 30px 10px 10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s;width:auto;min-width:150px;white-space:nowrap}.search-criteria[_ngcontent-%COMP%]:focus{border-color:#b0cfee;outline:none}.table-styling[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table-styling[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer;transition:background-color .3s}.table-styling[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background-color:#d1ecf1;color:#0c5460}.table-styling[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#d8eef1f4;cursor:pointer}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#333}.loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}"]})}return r})()}}]);