"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[320],{1320:(W,h,c)=>{c.r(h),c.d(h,{default:()=>Q});var p=c(177),g=c(2389),t=c(3953),m=c(2525),u=c(1626);let f=(()=>{class a{constructor(e){this.http=e,this.apiUrl=`${m.c.apiUrl}/api`,this.db=localStorage.getItem("devID")||""}getPersonels(){return this.http.get(`${this.apiUrl}/getPersonels?db=${this.db}`)}getPersonelTransaction(e){return this.http.get(`${this.apiUrl}/getPersonelTrans?db=${this.db}&pidtxt=${e}`)}getPersonelTransactionBydate(e,s,n){return this.http.get(`${this.apiUrl}/getPersonelTransByDate`,{params:{db:this.db,pid:e,startDate:s,endDate:n}})}getPersonelSalaryHistory(e){return this.http.get(`${this.apiUrl}/getSalaryHistoryByPID?db=${this.db}&pidtxt=${e}`)}getIncentives(e,s){return this.http.get(`${this.apiUrl}/getIncentive`,{params:{db:this.db,startDate:e,endDate:s}})}getSalarySettings(){return this.http.get(`${this.apiUrl}/salarysettings?db=${this.db}`)}getTankSumarry(e,s,n){return this.http.get(`${this.apiUrl}/TankInformation`,{params:{db:this.db,pidtxt:e,startDate:s,endDate:n}})}static#t=this.\u0275fac=function(s){return new(s||a)(t.KVO(u.Qq))};static#e=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var _=c(3525),d=c(4341),P=c(3413);const y=["personelDataModal"],F=["IncentiveModal"],v=["SummaryTankModal"];function k(a,r){1&a&&(t.j41(0,"div",14)(1,"div",15)(2,"p"),t.EFF(3,"Loading..."),t.k0s()()())}function D(a,r){if(1&a){const e=t.RV6();t.j41(0,"tr",20),t.bIt("click",function(){const n=t.eBV(e),i=n.$implicit,l=n.index,o=t.XpG(2);return t.Njj(o.OpenPersonelDataModal(i,l))}),t.j41(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"currency"),t.k0s()()}if(2&a){const e=r.$implicit,s=r.index,n=t.XpG(2);t.AVh("selected",s===n.clickedRowIndex),t.R7$(2),t.JRh(e.pname),t.R7$(2),t.JRh(e.paddress),t.R7$(2),t.JRh(e.pcontactnum),t.R7$(2),t.JRh(t.brH(9,6,e.ptotalpay,"PHP",!0))}}function b(a,r){if(1&a&&(t.j41(0,"div",16)(1,"table",17)(2,"thead")(3,"tr",18)(4,"th"),t.EFF(5,"Personel Name"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Address"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Contact Number"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Unpaid Salary"),t.k0s()()(),t.j41(12,"tbody"),t.DNE(13,D,10,10,"tr",19),t.k0s()()()),2&a){const e=t.XpG();t.R7$(13),t.Y8G("ngForOf",e.displayedPersonels)}}function j(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",21)(1,"button",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.currentPage-1))}),t.EFF(2," Previous "),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"button",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.currentPage+1))}),t.EFF(6," Next "),t.k0s()()}if(2&a){const e=t.XpG();t.R7$(),t.Y8G("disabled",1===e.currentPage),t.R7$(3),t.Lme("Page ",e.currentPage," of ",e.totalPages,""),t.R7$(),t.Y8G("disabled",e.currentPage===e.totalPages)}}function T(a,r){1&a&&(t.j41(0,"div",40)(1,"div",41)(2,"span",42),t.EFF(3,"Loading..."),t.k0s()()())}function C(a,r){1&a&&(t.j41(0,"div"),t.EFF(1,"No transactions available"),t.k0s())}function I(a,r){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s()()),2&a){const e=r.$implicit,s=t.XpG(5);t.R7$(2),t.JRh(s.formatDate(e.dtdate)),t.R7$(2),t.JRh(e.dtrefnum),t.R7$(2),t.JRh(e.dtcustname),t.R7$(2),t.JRh(e.deltype),t.R7$(2),t.JRh(e.itemsize),t.R7$(2),t.JRh(e.dtstatus)}}function R(a,r){if(1&a&&(t.j41(0,"table",17)(1,"thead")(2,"tr",18)(3,"th"),t.EFF(4,"Date"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Reference Number"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Customer"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Category"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Size"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Remarks"),t.k0s()()(),t.j41(15,"tbody"),t.DNE(16,I,13,6,"tr",52),t.k0s(),t.j41(17,"tfoot")(18,"tr",18)(19,"td",53),t.EFF(20,"Total Salary :"),t.k0s(),t.j41(21,"td"),t.EFF(22),t.nI1(23,"currency"),t.k0s()()()()),2&a){const e=t.XpG(4);t.R7$(16),t.Y8G("ngForOf",e.displayedTransactionDetails),t.R7$(6),t.JRh(t.i5U(23,2,e.getTotalSalary(),"PHP"))}}function E(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",21)(1,"button",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.goToTransactionPage(n.TransactionCurrentPage-1))}),t.EFF(2,"Previous"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"button",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.goToTransactionPage(n.TransactionCurrentPage+1))}),t.EFF(6,"Next"),t.k0s()()}if(2&a){const e=t.XpG(4);t.R7$(),t.Y8G("disabled",1===e.TransactionCurrentPage),t.R7$(3),t.Lme("Page ",e.TransactionCurrentPage," of ",e.TransactionTotalPages,""),t.R7$(),t.Y8G("disabled",e.TransactionCurrentPage===e.TransactionTotalPages)}}function S(a,r){if(1&a){const e=t.RV6();t.j41(0,"div")(1,"div",43)(2,"div",44)(3,"label",45),t.EFF(4,"Start Date:"),t.k0s(),t.j41(5,"input",46),t.mxI("ngModelChange",function(n){t.eBV(e);const i=t.XpG(3);return t.DH7(i.startDate,n)||(i.startDate=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.applyDateFilter())}),t.k0s()(),t.j41(6,"div",44)(7,"label",47),t.EFF(8,"End Date:"),t.k0s(),t.j41(9,"input",48),t.mxI("ngModelChange",function(n){t.eBV(e);const i=t.XpG(3);return t.DH7(i.endDate,n)||(i.endDate=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.applyDateFilter())}),t.k0s()(),t.j41(10,"div",49)(11,"button",50),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.showAllTransactions())}),t.EFF(12,"Show All"),t.k0s()()(),t.j41(13,"div",16),t.DNE(14,C,2,0,"div",39)(15,R,24,5,"table",51)(16,E,7,4,"div",13),t.k0s()()}if(2&a){const e=t.XpG(3);t.R7$(5),t.R50("ngModel",e.startDate),t.R7$(4),t.R50("ngModel",e.endDate),t.R7$(5),t.Y8G("ngIf",e.noTransactions),t.R7$(),t.Y8G("ngIf",!e.noTransactions),t.R7$(),t.Y8G("ngIf",!e.noTransactions)}}function x(a,r){if(1&a&&t.DNE(0,T,4,0,"div",38)(1,S,17,5,"div",39),2&a){const e=t.XpG(2);t.Y8G("ngIf",e.isLoading),t.R7$(),t.Y8G("ngIf",!e.isLoading)}}function M(a,r){1&a&&(t.j41(0,"div",40)(1,"div",41)(2,"span",42),t.EFF(3,"Loading..."),t.k0s()()())}function G(a,r){1&a&&(t.j41(0,"div"),t.EFF(1,"No Salary History available"),t.k0s())}function $(a,r){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"currency"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"currency"),t.k0s(),t.j41(9,"td"),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"td"),t.EFF(13),t.nI1(14,"currency"),t.k0s(),t.j41(15,"td"),t.EFF(16),t.nI1(17,"currency"),t.k0s(),t.j41(18,"td"),t.EFF(19),t.nI1(20,"currency"),t.k0s(),t.j41(21,"td"),t.EFF(22),t.k0s(),t.j41(23,"td"),t.EFF(24),t.k0s()()),2&a){const e=r.$implicit,s=t.XpG(5);t.R7$(2),t.JRh(s.formatDate(e.saldate)),t.R7$(2),t.JRh(t.i5U(5,9,e.saltotal,"PHP")),t.R7$(3),t.JRh(t.i5U(8,12,e.saldailypay,"PHP")),t.R7$(3),t.JRh(t.i5U(11,15,e.salincentive,"PHP")),t.R7$(3),t.JRh(t.i5U(14,18,e.saladdpay,"PHP")),t.R7$(3),t.JRh(t.i5U(17,21,e.sallesspay,"PHP")),t.R7$(3),t.JRh(t.i5U(20,24,e.salpaid,"PHP")),t.R7$(3),t.JRh(e.salpaidby),t.R7$(2),t.JRh(e.salremarks)}}function N(a,r){if(1&a&&(t.j41(0,"table",17)(1,"thead")(2,"tr",18)(3,"th"),t.EFF(4,"Date"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Salary"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Daily"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Incentive"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Additional"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Less"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Paid"),t.k0s(),t.j41(17,"th"),t.EFF(18,"Paid By"),t.k0s(),t.j41(19,"th"),t.EFF(20,"Remarks"),t.k0s()()(),t.j41(21,"tbody"),t.DNE(22,$,25,27,"tr",52),t.k0s(),t.j41(23,"tfoot")(24,"tr",18)(25,"td",58),t.EFF(26,"Total Salary Paid :"),t.k0s(),t.nrm(27,"td",59),t.j41(28,"td",60),t.EFF(29),t.nI1(30,"currency"),t.k0s()()()()),2&a){const e=t.XpG(4);t.R7$(22),t.Y8G("ngForOf",e.displayedSalaryDetails),t.R7$(7),t.JRh(t.i5U(30,2,e.getTotalPaidSalary(),"PHP"))}}function O(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",21)(1,"button",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.goToSalaryPage(n.salaryCurrentPage-1))}),t.EFF(2,"Previous"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"button",22),t.bIt("click",function(){t.eBV(e);const n=t.XpG(4);return t.Njj(n.goToSalaryPage(n.salaryCurrentPage+1))}),t.EFF(6,"Next"),t.k0s()()}if(2&a){const e=t.XpG(4);t.R7$(),t.Y8G("disabled",1===e.salaryCurrentPage),t.R7$(3),t.Lme("Page ",e.salaryCurrentPage," of ",e.salaryTotalPages,""),t.R7$(),t.Y8G("disabled",e.salaryCurrentPage===e.salaryTotalPages)}}function X(a,r){if(1&a){const e=t.RV6();t.j41(0,"div")(1,"div",43)(2,"div",44)(3,"label",54),t.EFF(4,"Start Date:"),t.k0s(),t.j41(5,"input",55),t.mxI("ngModelChange",function(n){t.eBV(e);const i=t.XpG(3);return t.DH7(i.startDate1,n)||(i.startDate1=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.applyDateFilterSalary())}),t.k0s()(),t.j41(6,"div",44)(7,"label",56),t.EFF(8,"End Date:"),t.k0s(),t.j41(9,"input",57),t.mxI("ngModelChange",function(n){t.eBV(e);const i=t.XpG(3);return t.DH7(i.endDate1,n)||(i.endDate1=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.applyDateFilterSalary())}),t.k0s()(),t.j41(10,"div",49)(11,"button",50),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.showAllSalary())}),t.EFF(12,"Show All"),t.k0s()()(),t.j41(13,"div",16),t.DNE(14,G,2,0,"div",39)(15,N,31,5,"table",51)(16,O,7,4,"div",13),t.k0s()()}if(2&a){const e=t.XpG(3);t.R7$(5),t.R50("ngModel",e.startDate1),t.R7$(4),t.R50("ngModel",e.endDate1),t.R7$(5),t.Y8G("ngIf",e.noSalary),t.R7$(),t.Y8G("ngIf",!e.noSalary),t.R7$(),t.Y8G("ngIf",!e.noSalary)}}function V(a,r){if(1&a&&t.DNE(0,M,4,0,"div",38)(1,X,17,5,"div",39),2&a){const e=t.XpG(2);t.Y8G("ngIf",e.isLoadingsalary),t.R7$(),t.Y8G("ngIf",!e.isLoadingsalary)}}function B(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",23)(1,"div",24)(2,"h4",25),t.EFF(3,"Personel Data"),t.k0s(),t.j41(4,"button",26),t.bIt("click",function(){const n=t.eBV(e).$implicit;return t.Njj(n.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",27)(6,"ul",28,3),t.mxI("activeIdChange",function(n){t.eBV(e);const i=t.XpG();return t.DH7(i.activeId,n)||(i.activeId=n),t.Njj(n)}),t.j41(8,"li",29)(9,"a",30),t.nrm(10,"i",31),t.EFF(11," Transaction History "),t.k0s(),t.DNE(12,x,2,2,"ng-template",32),t.k0s(),t.j41(13,"li",29)(14,"a",30),t.nrm(15,"i",33),t.EFF(16," Salary History "),t.k0s(),t.DNE(17,V,2,2,"ng-template",32),t.k0s()(),t.nrm(18,"div",34),t.k0s(),t.j41(19,"div",35)(20,"button",36),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.OpenIncentiveModal())}),t.EFF(21,"INCENTIVES"),t.k0s(),t.j41(22,"button",37),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.OpenTankInfoSummary())}),t.EFF(23,"SUMMARY"),t.k0s()()()}if(2&a){const e=t.sdS(7),s=t.XpG();t.R7$(6),t.R50("activeId",s.activeId),t.R7$(2),t.Y8G("ngbNavItem",1),t.R7$(5),t.Y8G("ngbNavItem",2),t.R7$(5),t.Y8G("ngbNavOutlet",e)}}function Y(a,r){1&a&&(t.j41(0,"div",40)(1,"div",41)(2,"span",42),t.EFF(3,"Loading..."),t.k0s()()())}function w(a,r){if(1&a&&(t.j41(0,"div",63)(1,"div",64)(2,"span",65),t.EFF(3,"Incentive Rate :"),t.k0s(),t.j41(4,"span",66),t.EFF(5),t.k0s()(),t.j41(6,"div",64)(7,"span",65),t.EFF(8,"Weight Quota :"),t.k0s(),t.j41(9,"span",66),t.EFF(10),t.k0s()()()),2&a){const e=r.$implicit;t.R7$(5),t.JRh(e.salpic||"0.00"),t.R7$(5),t.SpI("",e.salaccess||"0.0"," KG")}}function L(a,r){1&a&&(t.j41(0,"div"),t.EFF(1,"No Incentives Information"),t.k0s())}function H(a,r){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.j41(8,"td"),t.EFF(9),t.nI1(10,"currency"),t.k0s()()),2&a){const e=r.$implicit,s=t.XpG(4);t.R7$(2),t.JRh(s.formatDate(e.scdate)),t.R7$(2),t.JRh(e.total_kg_scqty),t.R7$(2),t.JRh(t.i5U(7,4,e.incrate,"PHP")),t.R7$(3),t.JRh(t.i5U(10,7,e.incentive,"PHP"))}}function z(a,r){if(1&a&&(t.j41(0,"table",17)(1,"thead")(2,"tr",18)(3,"th"),t.EFF(4,"Date"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Total Size"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Incentive Rate"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Incentive"),t.k0s()()(),t.j41(11,"tbody"),t.DNE(12,H,11,10,"tr",52),t.k0s()()),2&a){const e=t.XpG(3);t.R7$(12),t.Y8G("ngForOf",e.displayedIncentives)}}function J(a,r){if(1&a&&(t.j41(0,"div",16),t.DNE(1,L,2,0,"div",39)(2,z,13,1,"table",51),t.k0s()),2&a){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",e.noTransactions),t.R7$(),t.Y8G("ngIf",!e.noTransactions)}}function U(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",23)(1,"div",24)(2,"h4",25),t.EFF(3,"Incentives Information"),t.k0s(),t.j41(4,"button",26),t.bIt("click",function(){const n=t.eBV(e).$implicit;return t.Njj(n.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",27),t.DNE(6,Y,4,0,"div",38),t.j41(7,"div",61),t.DNE(8,w,11,2,"div",62),t.k0s(),t.DNE(9,J,3,2,"div",12),t.k0s()()}if(2&a){const e=t.XpG();t.R7$(6),t.Y8G("ngIf",e.isLoading),t.R7$(2),t.Y8G("ngForOf",e.salarysettings),t.R7$(),t.Y8G("ngIf",!e.isLoading)}}function A(a,r){if(1&a&&(t.j41(0,"div",63)(1,"div",64)(2,"span",65),t.EFF(3,"Total Tanks :"),t.k0s(),t.j41(4,"span",66),t.EFF(5),t.k0s()(),t.j41(6,"div",64)(7,"span",65),t.EFF(8,"Total KG :"),t.k0s(),t.j41(9,"span",66),t.EFF(10),t.k0s()()()),2&a){const e=r.$implicit;t.R7$(5),t.JRh(e.qty||"0"),t.R7$(5),t.SpI("",e.sizes||"0.0"," KG")}}function K(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",23)(1,"div",24)(2,"h4",25),t.EFF(3,"Weight Summary Information"),t.k0s(),t.j41(4,"button",26),t.bIt("click",function(){const n=t.eBV(e).$implicit;return t.Njj(n.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",27)(6,"div",61),t.DNE(7,A,11,2,"div",62),t.k0s()()()}if(2&a){const e=t.XpG();t.R7$(7),t.Y8G("ngForOf",e.tankInfo)}}let Q=(()=>{class a{constructor(e,s,n){this.personelService=e,this.modalService=s,this.datePipe=n,this.personels=[],this.displayedPersonels=[],this.filteredPersonels=[],this.loading=!1,this.currentPage=1,this.pageSize=10,this.totalPages=1,this.searchTerm="",this.searchCriteria="pname",this.clickedRowIndex=null,this.modalRef=null,this.selectedItem=null,this.personelDetails=[],this.filtertransactionDetails=[],this.transactionDetails=[],this.displayedTransactionDetails=[],this.TransactionCurrentPage=1,this.TransactionPageSize=5,this.TransactionTotalPages=1,this.noTransactions=!1,this.isLoading=!1,this.startDate="",this.endDate="",this.filterSalaryDetails=[],this.salaryDetails=[],this.displayedSalaryDetails=[],this.salaryCurrentPage=1,this.salaryPageSize=5,this.salaryTotalPages=1,this.noSalary=!1,this.isLoadingsalary=!1,this.startDate1="",this.endDate1="",this.activeTab="transaction-history",this.activeId=1,this.noIncentives=!1,this.isLoadingIncentive=!1,this.displayedIncentives=[],this.salarysettings=[],this.tankInfo=[]}ngOnInit(){this.loadPersonels()}formatDate(e){return this.datePipe.transform(e,"yyyy-MM-dd")||""}loadPersonels(){this.loading=!0,this.personelService.getPersonels().subscribe(e=>{this.personels=e,this.filteredPersonels=this.personels,this.totalPages=Math.ceil(this.filteredPersonels.length/this.pageSize),this.updateDisplayedPersonels(),this.loading=!1},e=>{this.loading=!1,console.error("Error fetching personels",e)})}updateDisplayedPersonels(){const e=(this.currentPage-1)*this.pageSize;this.displayedPersonels=this.filteredPersonels.slice(e,e+this.pageSize)}goToPage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,this.updateDisplayedPersonels())}searchPersonel(){this.filteredPersonels=this.personels.filter(e=>e[this.searchCriteria]?.toLowerCase().includes(this.searchTerm.toLowerCase())),this.totalPages=Math.ceil(this.filteredPersonels.length/this.pageSize),this.currentPage=1,this.updateDisplayedPersonels()}setActiveTab(e){this.activeTab=e}OpenPersonelDataModal(e,s){this.clickedRowIndex=s,this.selectedItem=e,this.modalRef=this.modalService.open(this.personelDataModal,{centered:!0,size:"xl"}),this.modalRef.result.finally(()=>this.resetSelection()),this.fetchSalesTransactions(e.pid).then(()=>{const n=new Date;this.startDate=this.formatDate(n),this.endDate=this.formatDate(n),this.applyDateFilter()}),this.fetchSalaryHistory(e.pid).then(()=>{const n=new Date;this.startDate1=this.formatDate(n),this.endDate1=this.formatDate(n),this.applyDateFilterSalary()})}fetchSalesTransactions(e){return this.isLoading=!0,new Promise((s,n)=>{this.personelService.getPersonelTransaction(e).subscribe(i=>{this.transactionDetails=i,this.TransactionTotalPages=Math.ceil(this.transactionDetails.length/this.TransactionPageSize),this.TransactionCurrentPage=1,this.noTransactions=0===this.transactionDetails.length,this.updateTransactionDisplayed(),this.isLoading=!1,s()},i=>{this.noTransactions=!0,this.isLoading=!1,console.error("Error fetching personel transactions",i),n(i)})})}getTotalSalary(){return this.filtertransactionDetails.filter(e=>"PAID"===e.dtstatus).reduce((e,s)=>e+s.dsalary,0)}updateTransactionDisplayed(){const e=(this.TransactionCurrentPage-1)*this.TransactionPageSize;this.displayedTransactionDetails=this.filtertransactionDetails.slice(e,e+this.TransactionPageSize)}goToTransactionPage(e){e>=1&&e<=this.TransactionTotalPages&&(this.TransactionCurrentPage=e,this.updateTransactionDisplayed())}applyDateFilter(){if(this.startDate&&this.endDate){const e=new Date(this.startDate),s=new Date(this.endDate);this.filtertransactionDetails=this.transactionDetails.filter(n=>{const i=new Date(n.dtdate);return i>=e&&i<=s})}else this.filtertransactionDetails=this.transactionDetails;this.noTransactions=0===this.filtertransactionDetails.length,this.TransactionTotalPages=Math.ceil(this.filtertransactionDetails.length/this.TransactionPageSize),this.TransactionCurrentPage=1,this.updateTransactionDisplayed()}resetSelection(){this.clickedRowIndex=null,this.selectedItem=null,this.startDate="",this.endDate="",this.activeTab="transaction-history"}showAllTransactions(){this.startDate="",this.endDate="",this.filtertransactionDetails=this.transactionDetails,this.noTransactions=0===this.filtertransactionDetails.length,this.TransactionTotalPages=Math.ceil(this.filtertransactionDetails.length/this.TransactionPageSize),this.TransactionCurrentPage=1,this.updateTransactionDisplayed()}fetchSalaryHistory(e){return this.isLoading=!0,new Promise((s,n)=>{this.personelService.getPersonelSalaryHistory(e).subscribe(i=>{this.salaryDetails=i,this.salaryTotalPages=Math.ceil(this.salaryDetails.length/this.salaryPageSize),this.salaryCurrentPage=1,this.noSalary=0===this.salaryDetails.length,this.updateTransactionDisplayed(),this.isLoadingsalary=!1,s()},i=>{this.noSalary=!0,this.isLoadingsalary=!1,console.error("Error fetching Salary History",i),n(i)})})}updateSalaryDisplayed(){const e=(this.salaryCurrentPage-1)*this.salaryPageSize;this.displayedSalaryDetails=this.filterSalaryDetails.slice(e,e+this.salaryPageSize)}goToSalaryPage(e){e>=1&&e<=this.salaryTotalPages&&(this.salaryCurrentPage=e,this.updateSalaryDisplayed())}applyDateFilterSalary(){if(this.startDate1&&this.endDate1){const e=new Date(this.startDate1),s=new Date(this.endDate1);this.filterSalaryDetails=this.salaryDetails.filter(n=>{const i=new Date(n.saldate);return i>=e&&i<=s})}else this.filterSalaryDetails=this.salaryDetails;this.noSalary=0===this.filterSalaryDetails.length,this.salaryTotalPages=Math.ceil(this.filterSalaryDetails.length/this.salaryPageSize),this.salaryCurrentPage=1,this.updateSalaryDisplayed()}getTotalPaidSalary(){return this.filterSalaryDetails.reduce((e,s)=>e+s.salpaid,0)}showAllSalary(){this.startDate1="",this.endDate1="",this.filterSalaryDetails=this.salaryDetails,this.noSalary=0===this.filterSalaryDetails.length,this.salaryTotalPages=Math.ceil(this.filterSalaryDetails.length/this.salaryPageSize),this.salaryCurrentPage=1,this.updateSalaryDisplayed()}OpenIncentiveModal(){this.fetchSalarySettings(),this.fetchIncentives(this.startDate,this.endDate),this.modalRef=this.modalService.open(this.incentiveModal,{centered:!0})}fetchIncentives(e,s){return this.isLoading=!0,new Promise((n,i)=>{this.personelService.getIncentives(e,s).subscribe(l=>{this.displayedIncentives=l,this.noIncentives=0===this.displayedIncentives.length,this.isLoading=!1,n()},l=>{this.noIncentives=!0,this.isLoading=!1,console.error("Error fetching Incentives",l),i(l)})})}fetchSalarySettings(){return this.isLoading=!0,new Promise((e,s)=>{this.personelService.getSalarySettings().subscribe(n=>{this.salarysettings=n,e()},n=>{console.error("Error fetching salary settings",n),s(n)})})}OpenTankInfoSummary(){this.fetchTankInfo(this.selectedItem.pid,this.startDate,this.endDate),this.modalRef=this.modalService.open(this.tankInfoModal,{centered:!0})}fetchTankInfo(e,s,n){return new Promise((i,l)=>{this.personelService.getTankSumarry(e,s,n).subscribe(o=>{this.tankInfo=o,i()},o=>{console.error("Error fetching Tank Summary",o),l(o)})})}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(f),t.rXU(_.Bq),t.rXU(p.vh))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-personels"]],viewQuery:function(s,n){if(1&s&&(t.GBs(y,5),t.GBs(F,5),t.GBs(v,5)),2&s){let i;t.mGM(i=t.lsd())&&(n.personelDataModal=i.first),t.mGM(i=t.lsd())&&(n.incentiveModal=i.first),t.mGM(i=t.lsd())&&(n.tankInfoModal=i.first)}},standalone:!0,features:[t.Jv_([p.vh]),t.aNF],decls:18,vars:6,consts:[["personelDataModal",""],["IncentiveModal",""],["SummaryTankModal",""],["nav","ngbNav"],[1,"col-xl-12"],["cardTitle","Personel List","blockClass","table-border-style",3,"options"],[1,"search-container"],["type","text","placeholder","Search personel...",1,"form-control","search-input",3,"ngModelChange","input","ngModel"],[1,"form-control","search-criteria",3,"ngModelChange","change","ngModel"],["value","pname"],["value","paddress"],["class","loading-overlay",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"table-responsive"],[1,"table","table-styling"],[1,"table-primary"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-dark",3,"click","disabled"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["ngbNav","",1,"nav-pills",3,"activeIdChange","activeId"],[1,"flex",3,"ngbNavItem"],["ngbNavLink",""],[1,"fa","fa-list","m-r-10"],["ngbNavContent",""],[1,"fa","fa-receipt","m-r-10"],[1,"mt-2",3,"ngbNavOutlet"],[1,"modal-footer"],[1,"btn","btn-primary","me-2",3,"click"],[1,"btn","btn-success",3,"click"],["class","text-center my-5",4,"ngIf"],[4,"ngIf"],[1,"text-center","my-5"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"row","mb-3","align-items-end"],[1,"col-12","col-md-4"],["for","startDate",1,"form-label"],["type","date","id","startDate",1,"form-control",3,"ngModelChange","change","ngModel"],["for","endDate",1,"form-label"],["type","date","id","endDate",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-12","col-md-4","text-md-end"],[1,"btn","btn-secondary","mt-3","mt-md-0",3,"click"],["class","table table-styling",4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","5",1,"text-right"],["for","startDate1",1,"form-label"],["type","date","id","startDate1",1,"form-control",3,"ngModelChange","change","ngModel"],["for","endDate1",1,"form-label"],["type","date","id","endDate1",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"text-left"],["colspan","5"],["colspan","3"],[1,"salary-settings"],["class","setting-item",4,"ngFor","ngForOf"],[1,"setting-item"],[1,"field"],[1,"label"],[1,"value"]],template:function(s,n){if(1&s){const i=t.RV6();t.j41(0,"div",4)(1,"app-card",5)(2,"div",6)(3,"input",7),t.mxI("ngModelChange",function(o){return t.eBV(i),t.DH7(n.searchTerm,o)||(n.searchTerm=o),t.Njj(o)}),t.bIt("input",function(){return t.eBV(i),t.Njj(n.searchPersonel())}),t.k0s(),t.j41(4,"select",8),t.mxI("ngModelChange",function(o){return t.eBV(i),t.DH7(n.searchCriteria,o)||(n.searchCriteria=o),t.Njj(o)}),t.bIt("change",function(){return t.eBV(i),t.Njj(n.searchPersonel())}),t.j41(5,"option",9),t.EFF(6,"Name"),t.k0s(),t.j41(7,"option",10),t.EFF(8,"Address"),t.k0s()()(),t.DNE(9,k,4,0,"div",11)(10,b,14,1,"div",12)(11,j,7,4,"div",13),t.k0s()(),t.DNE(12,B,24,4,"ng-template",null,0,t.C5r)(14,U,10,3,"ng-template",null,1,t.C5r)(16,K,8,1,"ng-template",null,2,t.C5r)}2&s&&(t.R7$(),t.Y8G("options",!1),t.R7$(2),t.R50("ngModel",n.searchTerm),t.R7$(),t.R50("ngModel",n.searchCriteria),t.R7$(5),t.Y8G("ngIf",n.loading),t.R7$(),t.Y8G("ngIf",!n.loading),t.R7$(),t.Y8G("ngIf",!n.loading&&n.displayedPersonels.length>0))},dependencies:[g.G,p.Sq,p.bT,d.xH,d.y7,d.me,d.wz,d.BC,d.vS,P.i,_.Um,_.X9,_.sy,_.Gx,_.Ri,_.WA,_.m_,p.oe],styles:[".search-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s;margin-right:10px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.search-container[_ngcontent-%COMP%]   .search-criteria[_ngcontent-%COMP%]{width:150px;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s}.search-container[_ngcontent-%COMP%]   .search-criteria[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#333}.loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.table-styling[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table-styling[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer;transition:background-color .3s}.table-styling[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background-color:#d1ecf1;color:#0c5460}.table-styling[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#d8eef1f4;cursor:pointer}.salary-settings[_ngcontent-%COMP%]{padding:15px}.setting-item[_ngcontent-%COMP%]{margin-bottom:15px}.field[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.label[_ngcontent-%COMP%]{font-weight:700;margin:0}.value[_ngcontent-%COMP%]{font-weight:400;margin:0}span[_ngcontent-%COMP%]{display:inline-block}h6[_ngcontent-%COMP%]{font-size:1rem;margin:0}"]})}return a})()}}]);