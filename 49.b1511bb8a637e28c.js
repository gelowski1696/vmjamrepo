"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[49],{6049:(J,m,l)=>{l.r(m),l.d(m,{default:()=>H});var c=l(177),p=l(6661),u=l(1413),D=l(2389),t=l(3953),f=l(7004),C=l(3525),R=l(2646),d=l(4341),y=l(3413);const F=["SalesReportModal"],b=["ReportSummary"],S=["ItemInsight"],j=["SalesInsightModal"],v=["SummaryCSV"];function k(i,o){1&i&&(t.j41(0,"div",21)(1,"div",22)(2,"span",23),t.EFF(3,"Loading..."),t.k0s()()())}function E(i,o){if(1&i&&(t.j41(0,"div",33)(1,"div",31)(2,"strong",34),t.EFF(3),t.k0s(),t.j41(4,"span",32),t.EFF(5),t.nI1(6,"currency"),t.k0s()()()),2&i){const e=o.$implicit;t.R7$(2),t.Y8G("ngClass",e.isDanger?"text-nowrap text-danger":"text-nowrap"),t.R7$(),t.JRh(e.label),t.R7$(2),t.JRh(t.i5U(6,3,e.value,"PHP"))}}function I(i,o){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"div",24)(2,"label",25)(3,"strong"),t.EFF(4,"Date:"),t.k0s()(),t.j41(5,"input",26),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.startDate,a)||(n.startDate=a),t.Njj(a)}),t.bIt("change",function(a){t.eBV(e);const n=t.XpG(2);return t.Njj(n.onDateChange(a))}),t.k0s()(),t.j41(6,"app-card",27),t.DNE(7,E,7,6,"div",28),t.nrm(8,"hr",29),t.j41(9,"div",30)(10,"div",31)(11,"h4"),t.EFF(12,"TOTAL SALES:"),t.k0s(),t.j41(13,"h5",32),t.EFF(14),t.nI1(15,"currency"),t.k0s()()()()()}if(2&i){const e=t.XpG(2);t.R7$(5),t.R50("ngModel",e.startDate),t.R7$(),t.Y8G("hidHeader",!0)("options",!1),t.R7$(),t.Y8G("ngForOf",e.reportItems),t.R7$(7),t.SpI(" ",t.i5U(15,5,e.salesreport[0].tender+e.salesreport[0].totalcreditpay-e.salesreport[0].totalexpense-e.salesreport[0].totalsalpaid+e.salesreport[0].totalcashin-e.salesreport[0].purchase,"PHP")," ")}}function M(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15)(2,"h4",16),t.EFF(3,"Sales Report"),t.k0s(),t.j41(4,"button",17),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",18),t.DNE(6,k,4,0,"div",19)(7,I,16,8,"div",20),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("ngIf",e.loading),t.R7$(),t.Y8G("ngIf",!e.loading)}}function T(i,o){1&i&&(t.j41(0,"div",21)(1,"div",22)(2,"span",23),t.EFF(3,"Loading..."),t.k0s()()())}function x(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",37)(1,"div",38)(2,"label",39),t.EFF(3,"Start Date:"),t.k0s(),t.j41(4,"input",40),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.startDateSummary,a)||(n.startDateSummary=a),t.Njj(a)}),t.bIt("ngModelChange",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onDateChangeSummary())}),t.k0s()(),t.j41(5,"div",38)(6,"label",41),t.EFF(7,"End Date:"),t.k0s(),t.j41(8,"input",42),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.endDateSummary,a)||(n.endDateSummary=a),t.Njj(a)}),t.bIt("ngModelChange",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onDateChangeSummary())}),t.k0s()()()}if(2&i){const e=t.XpG(2);t.R7$(4),t.R50("ngModel",e.startDateSummary),t.R7$(4),t.R50("ngModel",e.endDateSummary)}}function P(i,o){if(1&i&&(t.j41(0,"app-card",43)(1,"div",44)(2,"h4",45)(3,"span"),t.EFF(4),t.k0s()(),t.j41(5,"h4",46)(6,"span"),t.EFF(7),t.nI1(8,"currency"),t.k0s()()()()),2&i){const e=o.$implicit;t.Y8G("hidHeader",!0),t.R7$(4),t.JRh(e.label),t.R7$(3),t.JRh(t.i5U(8,3,e.value,"PHP"))}}function G(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15)(2,"h4",16),t.EFF(3,"Sales Report Summary"),t.k0s(),t.j41(4,"button",17),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",18),t.DNE(6,T,4,0,"div",19)(7,x,9,2,"div",35)(8,P,9,6,"app-card",36),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("ngIf",e.loading),t.R7$(),t.Y8G("ngIf",!e.loading),t.R7$(),t.Y8G("ngForOf",e.summaryItems)}}function O(i,o){1&i&&(t.j41(0,"div",21)(1,"div",22)(2,"span",23),t.EFF(3,"Loading..."),t.k0s()()())}function A(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",37)(1,"div",38)(2,"label",49),t.EFF(3,"Start Date:"),t.k0s(),t.j41(4,"input",50),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.insightstartDate,a)||(n.insightstartDate=a),t.Njj(a)}),t.bIt("ngModelChange",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onDateChangeItemInsight())}),t.k0s()(),t.j41(5,"div",38)(6,"label",51),t.EFF(7,"End Date:"),t.k0s(),t.j41(8,"input",52),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.insightendDate,a)||(n.insightendDate=a),t.Njj(a)}),t.bIt("ngModelChange",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onDateChangeItemInsight())}),t.k0s()()()}if(2&i){const e=t.XpG(2);t.R7$(4),t.R50("ngModel",e.insightstartDate),t.R7$(4),t.R50("ngModel",e.insightendDate)}}function B(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15)(2,"h4",16),t.EFF(3,"Item Insights"),t.k0s(),t.j41(4,"button",17),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",18),t.DNE(6,O,4,0,"div",19)(7,A,9,2,"div",35),t.j41(8,"div",47)(9,"app-card",27),t.nrm(10,"apx-chart",48),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("ngIf",e.loading),t.R7$(),t.Y8G("ngIf",!e.loading),t.R7$(2),t.Y8G("hidHeader",!0)("options",!1),t.R7$(),t.Y8G("labels",e.pie1CAC.labels)("chart",e.pie1CAC.chart)("dataLabels",e.pie1CAC.dataLabels)("series",e.pie1CAC.series)("colors",e.pie1CAC.colors)("responsive",e.pie1CAC.responsive)("legend",e.pie1CAC.legend)}}function N(i,o){1&i&&(t.j41(0,"div",21)(1,"div",22)(2,"span",23),t.EFF(3,"Loading..."),t.k0s()()())}function V(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",37)(1,"div",38)(2,"label",56),t.EFF(3,"Start Date:"),t.k0s(),t.j41(4,"input",57),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.salesinsightstartDate,a)||(n.salesinsightstartDate=a),t.Njj(a)}),t.bIt("ngModelChange",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onDateChangeSalesInsight())}),t.k0s()(),t.j41(5,"div",38)(6,"label",58),t.EFF(7,"End Date:"),t.k0s(),t.j41(8,"input",59),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG(2);return t.DH7(n.salesinsightendDate,a)||(n.salesinsightendDate=a),t.Njj(a)}),t.bIt("ngModelChange",function(){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onDateChangeSalesInsight())}),t.k0s()()()}if(2&i){const e=t.XpG(2);t.R7$(4),t.R50("ngModel",e.salesinsightstartDate),t.R7$(4),t.R50("ngModel",e.salesinsightendDate)}}function $(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15)(2,"h4",16),t.EFF(3,"Sales Insights"),t.k0s(),t.j41(4,"button",17),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",18),t.DNE(6,N,4,0,"div",19)(7,V,9,2,"div",35),t.j41(8,"div",53)(9,"div",38)(10,"button",54),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.filterBy("week"))}),t.EFF(11,"This Week"),t.k0s(),t.j41(12,"button",54),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.filterBy("month"))}),t.EFF(13,"This Month"),t.k0s(),t.j41(14,"button",54),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.filterBy("year"))}),t.EFF(15,"This Year"),t.k0s()()(),t.j41(16,"div",47)(17,"app-card",27),t.nrm(18,"apx-chart",55),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("ngIf",e.loading),t.R7$(),t.Y8G("ngIf",!e.loading),t.R7$(10),t.Y8G("hidHeader",!0)("options",!1),t.R7$(),t.Y8G("dataLabels",e.line1CAC.dataLabels)("chart",e.line1CAC.chart)("stroke",e.line1CAC.stroke)("colors",e.line1CAC.colors)("series",e.line1CAC.series)("title",e.line1CAC.title)("grid",e.line1CAC.grid)("xaxis",e.line1CAC.xaxis)}}function w(i,o){1&i&&(t.j41(0,"div",21)(1,"div",22)(2,"span",23),t.EFF(3,"Loading..."),t.k0s()()())}function L(i,o){1&i&&(t.j41(0,"tr")(1,"td",74),t.EFF(2,"No Data Available"),t.k0s()())}function Y(i,o){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s(),t.j41(17,"td"),t.EFF(18),t.k0s(),t.j41(19,"td"),t.EFF(20),t.k0s(),t.j41(21,"td"),t.EFF(22),t.k0s(),t.j41(23,"td"),t.EFF(24),t.k0s(),t.j41(25,"td"),t.EFF(26),t.k0s()()),2&i){const e=o.$implicit;t.R7$(2),t.JRh(e.itemcode),t.R7$(2),t.JRh(e.fillqty),t.R7$(2),t.JRh(e.emptyqty),t.R7$(2),t.JRh(e.totalqty),t.R7$(2),t.JRh(e.deliveries),t.R7$(2),t.JRh(e.sales),t.R7$(2),t.JRh(e.R),t.R7$(2),t.JRh(e.pullout),t.R7$(2),t.JRh(e.DEFF),t.R7$(2),t.JRh(e.BL),t.R7$(2),t.JRh(e.clfill),t.R7$(2),t.JRh(e.clempty),t.R7$(2),t.JRh(e.cltotalqty)}}function X(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15)(2,"h4",16),t.EFF(3,"Summary CSV"),t.k0s(),t.j41(4,"button",17),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("Cross click"))}),t.k0s()(),t.j41(5,"div",18),t.DNE(6,w,4,0,"div",19),t.j41(7,"div",37)(8,"div",38)(9,"label",60),t.EFF(10,"Start Date:"),t.k0s(),t.j41(11,"input",61),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG();return t.DH7(n.sumamrycsvStartDate,a)||(n.sumamrycsvStartDate=a),t.Njj(a)}),t.bIt("change",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.onDateRangeChange())}),t.k0s()(),t.j41(12,"div",38)(13,"label",62),t.EFF(14,"End Date:"),t.k0s(),t.j41(15,"input",63),t.mxI("ngModelChange",function(a){t.eBV(e);const n=t.XpG();return t.DH7(n.sumamrycsvEndDate,a)||(n.sumamrycsvEndDate=a),t.Njj(a)}),t.bIt("change",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.onDateRangeChange())}),t.k0s()()(),t.j41(16,"app-card",27)(17,"div",64)(18,"table",65)(19,"thead")(20,"tr",66)(21,"th",67),t.EFF(22,"Item Code"),t.k0s(),t.j41(23,"th",68),t.EFF(24,"OPENING"),t.k0s(),t.nrm(25,"th")(26,"th"),t.j41(27,"th",69),t.EFF(28,"RETURN"),t.k0s(),t.j41(29,"th",70),t.EFF(30,"ACTUAL"),t.k0s()(),t.j41(31,"tr",66)(32,"th"),t.EFF(33,"Filled"),t.k0s(),t.j41(34,"th"),t.EFF(35,"Empty"),t.k0s(),t.j41(36,"th"),t.EFF(37,"Total"),t.k0s(),t.j41(38,"th"),t.EFF(39,"Deliveries"),t.k0s(),t.j41(40,"th"),t.EFF(41,"Sales"),t.k0s(),t.j41(42,"th"),t.EFF(43,"Refill"),t.k0s(),t.j41(44,"th"),t.EFF(45,"Pull Out"),t.k0s(),t.j41(46,"th"),t.EFF(47,"Deffective"),t.k0s(),t.j41(48,"th"),t.EFF(49,"Backload"),t.k0s(),t.j41(50,"th"),t.EFF(51,"Filled"),t.k0s(),t.j41(52,"th"),t.EFF(53,"Empty"),t.k0s(),t.j41(54,"th"),t.EFF(55,"Total"),t.k0s()()(),t.j41(56,"tbody"),t.DNE(57,L,3,0,"tr",20)(58,Y,27,13,"tr",71),t.k0s()(),t.j41(59,"div",72)(60,"button",73),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.previousPage())}),t.EFF(61,"Previous Page"),t.k0s(),t.j41(62,"span"),t.EFF(63),t.k0s(),t.j41(64,"button",73),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.nextPage())}),t.EFF(65,"Next Page"),t.k0s()()()(),t.j41(66,"div",72)(67,"button",73),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.previousDate())}),t.EFF(68,"Previous Date"),t.k0s(),t.j41(69,"span"),t.EFF(70),t.nI1(71,"date"),t.k0s(),t.j41(72,"button",73),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.nextDate())}),t.EFF(73,"Next Date"),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(6),t.Y8G("ngIf",e.loading),t.R7$(5),t.R50("ngModel",e.sumamrycsvStartDate),t.R7$(4),t.R50("ngModel",e.sumamrycsvEndDate),t.R7$(),t.Y8G("hidHeader",!0)("options",!1),t.R7$(41),t.Y8G("ngIf",0===e.summarycsvDetails.length),t.R7$(),t.Y8G("ngForOf",e.paginatedDetails),t.R7$(2),t.Y8G("disabled",1===e.currentPage),t.R7$(3),t.Lme("Page ",e.currentPage," of ",e.totalPages,""),t.R7$(),t.Y8G("disabled",e.currentPage===e.totalPages),t.R7$(3),t.Y8G("disabled",e.isPreviousDisabled()),t.R7$(3),t.SpI("Date: ",t.i5U(71,14,e.currentDate,"yyyy-MM-dd"),""),t.R7$(2),t.Y8G("disabled",e.isNextDisabled())}}let H=(()=>{class i{constructor(e,s,a,n){this.salesService=e,this.modalService=s,this.salesCartService=a,this.datePipe=n,this.destroy$=new u.B,this.loading=!1,this.startDate="",this.endDate="",this.modalRef=null,this.salesreport=[],this.reportItems=[],this.summarydata=[],this.summaryItems=[],this.startDateSummary="",this.endDateSummary="",this.insightstartDate="",this.insightendDate="",this.insightsData=[],this.salesinsightstartDate="",this.salesinsightendDate="",this.salesinsightsData=[],this.sumamrycsvStartDate="",this.sumamrycsvEndDate="",this.summarycsvDetails=[],this.currentDate=new Date,this.startDate1=null,this.endDate1=null,this.paginatedDetails=[],this.currentPage=1,this.itemsPerPage=10,this.totalItems=0,this.totalPages=0,this.pie1CAC={labels:[],series:[],chart:{type:"pie",height:350,toolbar:{show:!0,tools:{download:!0}}},dataLabels:{enabled:!0},colors:["#FF4560","#00E396","#008FFB","#FF9F00","#FF0000","#00FF00","#0000FF","#FFC0CB","#800080","#FFD700"],responsive:[{breakpoint:1200,options:{chart:{width:"80%"},legend:{position:"bottom"}}},{breakpoint:768,options:{chart:{width:"90%"},legend:{position:"bottom"}}},{breakpoint:480,options:{chart:{width:"100%",height:300},legend:{position:"bottom",fontSize:"10px"},dataLabels:{style:{fontSize:"10px"}}}}],legend:{show:!0,position:"bottom"},toolbar:{show:!0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0}}},this.line1CAC={chart:{type:"line",height:350},dataLabels:{enabled:!0},stroke:{curve:"smooth"},colors:["#FF4560","#00E396","#008FFB","#FF6600","#775DD0","#546E7A","#26A69A","#D10CE8","#FFB400","#FF9F00"],series:[],title:{text:"Profit",align:"left"},grid:{show:!0},xaxis:{categories:[]}}}ngOnInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.resetChartData()}resetChartData(){this.pie1CAC.labels=[],this.pie1CAC.series=[]}formatDate(e){return this.datePipe.transform(e,"yyyy-MM-dd")||""}openReportSales(){const e=(new Date).toISOString().split("T")[0];this.startDate=e,this.fetchSalesForDate(this.startDate),this.modalRef=this.modalService.open(this.SalesReportModal,{centered:!0}),this.modalRef.result.finally(()=>this.resetSelection())}resetSelection(){this.startDate="",this.endDate="",this.startDateSummary="",this.endDateSummary="",this.insightstartDate="",this.insightendDate="",this.resetChartData(),this.currentDate=new Date,this.startDate1=new Date,this.endDate1=new Date}loadReportSales(e){return this.loading=!0,new Promise((s,a)=>{this.salesService.getReportSales(e).subscribe(n=>{this.salesreport=n,this.initializeReportItems(),this.loading=!1,s()},n=>{this.loading=!1,console.error("Error fetching loadReportSales",n),a(n)})})}initializeReportItems(){this.salesreport.length>0&&(this.reportItems=[{label:"TOTAL NET SALES:",value:this.salesreport[0].total+this.salesreport[0].totaldiscount+this.salesreport[0].spcdisc,isDanger:!1},{label:"TOTAL CASH:",value:this.salesreport[0].totaltender+this.salesreport[0].totalcreditcash,isDanger:!1},{label:"TOTAL GCASH:",value:this.salesreport[0].totalgcash+this.salesreport[0].totalcreditgcash,isDanger:!1},{label:"TOTAL BANK TRANSFER:",value:this.salesreport[0].totalbank+this.salesreport[0].totalcreditbank,isDanger:!1},{label:"TOTAL PAID CREDIT:",value:this.salesreport[0].totalcreditpay,isDanger:!1},{label:"TOTAL CAPITAL:",value:this.salesreport[0].totalcashin,isDanger:!1},{label:"TOTAL DISCOUNTS:",value:this.salesreport[0].totaldiscount,isDanger:!0},{label:"TOTAL SPECIAL DISCOUNTS:",value:this.salesreport[0].spcdisc,isDanger:!0},{label:"TOTAL CREDIT:",value:this.salesreport[0].totalcredit,isDanger:!0},{label:"TOTAL PURCHASE:",value:this.salesreport[0].purchase,isDanger:!0},{label:"TOTAL EXPENSE:",value:this.salesreport[0].totalexpense,isDanger:!0},{label:"TOTAL SALARY PAID:",value:this.salesreport[0].totalsalpaid,isDanger:!0}])}fetchSalesForDate(e){this.loadReportSales(e)}onDateChange(e){this.startDate=e.target.value,this.loadReportSales(this.startDate)}openReportSummary(){const e=(new Date).toISOString().split("T")[0];this.startDateSummary=e,this.endDateSummary=e,this.fetchSummaryForDate(this.startDateSummary,this.endDateSummary),this.modalRef=this.modalService.open(this.ReportSummary,{centered:!0}),this.modalRef.result.finally(()=>this.resetSelection())}fetchSummaryForDate(e,s){this.loadSUmmaryReport(e,s)}loadSUmmaryReport(e,s){return this.loading=!0,new Promise((a,n)=>{this.salesService.getReportSummary(e,s).subscribe(r=>{this.summarydata=r,this.summaryitemsload(),this.loading=!1,a()},r=>{this.loading=!1,console.error("Error fetching loadSUmmaryReport",r),n(r)})})}onDateChangeSummary(){this.fetchSummaryForDate(this.startDateSummary,this.endDateSummary)}summaryitemsload(){this.summarydata.length>0&&(this.summaryItems=[{label:"NET SALES :",value:this.summarydata[0].total+this.summarydata[0].totaldiscount+this.summarydata[0].spcdisc},{label:"COST OF PRODUCT SOLD :",value:this.summarydata[0].sumcost},{label:"MARGIN :",value:this.summarydata[0].total+this.summarydata[0].totaldiscount+this.summarydata[0].spcdisc-this.summarydata[0].sumcost},{label:"INCOME :",value:this.summarydata[0].totalcreditpay+this.summarydata[0].totalcashin},{label:"EXPENSES :",value:this.summarydata[0].totalexpense+this.summarydata[0].totalcredit+this.summarydata[0].totalsalpaid+this.summarydata[0].totaldiscount+this.summarydata[0].purchase+this.summarydata[0].spcdisc},{label:"PROFIT :",value:this.summarydata[0].total+this.summarydata[0].totaldiscount+this.summarydata[0].spcdisc-this.summarydata[0].sumcost+(this.summarydata[0].totalcreditpay+this.summarydata[0].totalcashin)-(this.summarydata[0].totalexpense+this.summarydata[0].totalcredit+this.summarydata[0].totalsalpaid+this.summarydata[0].totaldiscount+this.summarydata[0].purchase+this.summarydata[0].spcdisc)}])}openItemInsightsModal(){const e=(new Date).toISOString().split("T")[0];this.insightstartDate=e,this.insightendDate=e,this.fetchInsights(this.insightstartDate,this.insightendDate),this.modalRef=this.modalService.open(this.ItemInsight,{centered:!0,size:"lg"}),this.modalRef.result.finally(()=>this.resetSelection())}fetchInsights(e,s){this.loadItemInsights(e,s)}onDateChangeItemInsight(){this.fetchInsights(this.insightstartDate,this.insightendDate)}loadItemInsights(e,s){return this.loading=!0,new Promise((a,n)=>{this.salesCartService.getItemInsights(e,s).subscribe(r=>{this.insightsData=r,this.updateChartData(),this.loading=!1,a()},r=>{this.loading=!1,console.error("Error fetching loadItemInsights",r),n(r)})})}updateChartData(){this.insightsData&&this.insightsData.length>0&&(this.pie1CAC.labels=this.insightsData.map(e=>e.scitemcode),this.pie1CAC.series=this.insightsData.map(e=>e.scqty))}openSalesInsightModal(){const e=(new Date).toISOString().split("T")[0];this.salesinsightstartDate=e,this.salesinsightendDate=e,this.fetchSalesInsights(this.salesinsightstartDate,this.salesinsightendDate),this.modalRef=this.modalService.open(this.SalesInsightModal,{centered:!0,size:"lg"}),this.modalRef.result.finally(()=>this.resetSelection())}fetchSalesInsights(e,s){this.loadSalesInsights(e,s)}onDateChangeSalesInsight(){this.loadSalesInsights(this.salesinsightstartDate,this.salesinsightendDate)}loadSalesInsights(e,s){return this.loading=!0,new Promise((a,n)=>{this.salesService.getSalesInsight(e,s).subscribe(r=>{this.salesinsightsData=r,this.updateChartDataSales(r),this.loading=!1,a()},r=>{this.loading=!1,console.error("Error fetching loadSalesInsights",r),n(r)})})}updateChartDataSales(e){let s=[],a=[];this.salesinsightstartDate&&this.salesinsightendDate&&this.salesinsightstartDate.slice(0,4)===this.salesinsightendDate.slice(0,4)&&"01-01"===this.salesinsightstartDate.slice(5)&&"12-31"===this.salesinsightendDate.slice(5)?(s=["January","February","March","April","May","June","July","August","September","October","November","December"],a=[{name:"Profit",data:e.reduce((h,_)=>{const g=new Date(_.cdate).getMonth();return h[g]=(h[g]||0)+_.profit,h},Array(12).fill(0))}]):(s=e.map(r=>r.cdate),a=[{name:"Profit",data:e.map(r=>r.profit)}]),this.line1CAC.xaxis={categories:s},this.line1CAC.series=a}filterBy(e){const s=new Date;let a=s,n=s;"week"===e?(a=this.getStartOfWeek(s),n=this.getEndOfWeek(s)):"month"===e?(a=new Date(s.getFullYear(),s.getMonth(),1),n=new Date(s.getFullYear(),s.getMonth()+1,0)):"year"===e&&(a=new Date(s.getFullYear(),0,1),n=new Date(s.getFullYear(),11,31)),this.salesinsightstartDate=this.formatDate1(a),this.salesinsightendDate=this.formatDate1(n),this.onDateChangeSalesInsight()}getStartOfWeek(e){const s=e.getDay(),a=e.getDate()-s+(0===s?-6:1);return new Date(e.setDate(a))}getEndOfWeek(e){const s=this.getStartOfWeek(e);return new Date(s.getFullYear(),s.getMonth(),s.getDate()+6)}formatDate1(e){return`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}-${("0"+e.getDate()).slice(-2)}`}openSummaryCSVModal(){const e=(new Date).toISOString().split("T")[0];this.sumamrycsvStartDate=e,this.sumamrycsvEndDate=e,this.currentPage=1,this.loadSummaryCSV(e),this.modalRef=this.modalService.open(this.SummaryCSV,{centered:!0,size:"xl"}),this.modalRef.result.finally(()=>this.resetSelection())}loadSummaryCSV(e){return new Promise((s,a)=>{this.salesCartService.getSummaryCSV(e).subscribe(n=>{this.summarycsvDetails=n,this.totalItems=this.summarycsvDetails.length,this.totalPages=Math.ceil(this.totalItems/this.itemsPerPage),this.updatePaginatedDetails(),s()},n=>{console.error("Error fetching loadSummaryCSV",n),a(n)})})}updatePaginatedDetails(){const e=(this.currentPage-1)*this.itemsPerPage;this.paginatedDetails=this.summarycsvDetails.slice(e,e+this.itemsPerPage)}onDateRangeChange(){this.startDate1=new Date(this.sumamrycsvStartDate),this.endDate1=new Date(this.sumamrycsvEndDate),this.currentDate=this.startDate1,this.currentPage=1,this.currentDate&&this.loadSummaryCSV(this.currentDate.toISOString().split("T")[0])}previousDate(){if(this.currentDate&&this.startDate1){const e=new Date(this.currentDate);e.setDate(e.getDate()-1),e>=this.startDate1&&(this.currentDate=e,this.loadSummaryCSV(this.currentDate.toISOString().split("T")[0]))}}nextDate(){if(this.currentDate&&this.endDate1){const e=new Date(this.currentDate);e.setDate(e.getDate()+1),e<=this.endDate1&&(this.currentDate=e,this.loadSummaryCSV(this.currentDate.toISOString().split("T")[0]))}}isPreviousDisabled(){return!this.startDate1||!this.currentDate||this.currentDate<=this.startDate1}isNextDisabled(){return!this.endDate1||!this.currentDate||this.currentDate>=this.endDate1}previousPage(){this.currentPage>1&&(this.currentPage--,this.updatePaginatedDetails())}nextPage(){const e=Math.ceil(this.totalItems/this.itemsPerPage);this.currentPage<e&&(this.currentPage++,this.updatePaginatedDetails())}static#t=this.\u0275fac=function(s){return new(s||i)(t.rXU(f.j),t.rXU(C.Bq),t.rXU(R.J),t.rXU(c.vh))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-reports"]],viewQuery:function(s,a){if(1&s&&(t.GBs(F,5),t.GBs(b,5),t.GBs(S,5),t.GBs(j,5),t.GBs(v,5)),2&s){let n;t.mGM(n=t.lsd())&&(a.SalesReportModal=n.first),t.mGM(n=t.lsd())&&(a.ReportSummary=n.first),t.mGM(n=t.lsd())&&(a.ItemInsight=n.first),t.mGM(n=t.lsd())&&(a.SalesInsightModal=n.first),t.mGM(n=t.lsd())&&(a.SummaryCSV=n.first)}},standalone:!0,features:[t.Jv_([c.vh]),t.aNF],decls:37,vars:5,consts:[["SalesReportModal",""],["ReportSummary",""],["ItemInsight",""],["SalesInsightModal",""],["SummaryCSV",""],[1,"container"],[1,"row"],[1,"col-md-6","col-lg-4","mb-4"],["blockClass","text-center",3,"click","hidHeader"],[1,"fa","fa-poll","text-c-blue","d-block","f-40"],[1,"m-t-20"],[1,"fas","fa-chart-pie","text-c-blue","d-block","f-40"],[1,"fas","fa-chart-line","text-c-blue","d-block","f-40"],[1,"fas","fa-table","text-c-blue","d-block","f-40"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","d-flex justify-content-center align-items-center vh-100",4,"ngIf"],[4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center","vh-100"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"row","mb-3","align-items-end","px-3"],["for","startDate",1,"form-label"],["type","date","id","startDate",1,"form-control",3,"ngModelChange","change","ngModel"],[3,"hidHeader","options"],["class","row mb-2",4,"ngFor","ngForOf"],[1,"hr"],[1,"row","mb-3"],[1,"col-12","d-flex","justify-content-between"],[1,"text-nowrap"],[1,"row","mb-2"],[3,"ngClass"],["class","row mb-3 align-items-end justify-content-center",4,"ngIf"],["cardClass","bg-c-blue order-card mb-3",3,"hidHeader",4,"ngFor","ngForOf"],[1,"row","mb-3","align-items-end","justify-content-center"],[1,"col-auto"],["for","startDateSummary",1,"form-label"],["type","date","id","startDateSummary",1,"form-control",3,"ngModelChange","ngModel"],["for","endDateSummary",1,"form-label"],["type","date","id","endDateSummary",1,"form-control",3,"ngModelChange","ngModel"],["cardClass","bg-c-blue order-card mb-3",3,"hidHeader"],[1,"d-flex","justify-content-between"],[1,"text-start","text-white","mb-0"],[1,"text-end","text-white","mb-0"],[1,"container-fluid"],[3,"labels","chart","dataLabels","series","colors","responsive","legend"],["for","insightstartDate",1,"form-label"],["type","date","id","insightstartDate",1,"form-control",3,"ngModelChange","ngModel"],["for","insightendDate",1,"form-label"],["type","date","id","insightendDate",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","mb-3","justify-content-center"],[1,"btn","btn-outline-primary","mx-2",3,"click"],[3,"dataLabels","chart","stroke","colors","series","title","grid","xaxis"],["for","salesinsightstartDate",1,"form-label"],["type","date","id","salesinsightstartDate",1,"form-control",3,"ngModelChange","ngModel"],["for","salesinsightendDate",1,"form-label"],["type","date","id","salesinsightendDate",1,"form-control",3,"ngModelChange","ngModel"],["for","sumamrycsvStartDate",1,"form-label"],["type","date","id","sumamrycsvStartDate",1,"form-control",3,"ngModelChange","change","ngModel"],["for","sumamrycsvEndDate",1,"form-label"],["type","date","id","sumamrycsvEndDate",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"table-responsive"],[1,"table","table-styling"],[1,"table-primary"],["rowspan","2"],["colspan","3",1,"opening-header"],["colspan","4",1,"return-header"],["colspan","3",1,"actual-header"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-dark",3,"click","disabled"],["colspan","3",1,"text-center"]],template:function(s,a){if(1&s){const n=t.RV6();t.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"app-card",8),t.bIt("click",function(){return t.eBV(n),t.Njj(a.openReportSales())}),t.nrm(4,"i",9),t.j41(5,"h4",10),t.EFF(6,"Sales Report"),t.k0s()()(),t.j41(7,"div",7)(8,"app-card",8),t.bIt("click",function(){return t.eBV(n),t.Njj(a.openReportSummary())}),t.nrm(9,"i",9),t.j41(10,"h4",10),t.EFF(11,"Report Summary"),t.k0s()()(),t.j41(12,"div",7)(13,"app-card",8),t.bIt("click",function(){return t.eBV(n),t.Njj(a.openItemInsightsModal())}),t.nrm(14,"i",11),t.j41(15,"h4",10),t.EFF(16,"Item Insights"),t.k0s()()(),t.j41(17,"div",7)(18,"app-card",8),t.bIt("click",function(){return t.eBV(n),t.Njj(a.openSalesInsightModal())}),t.nrm(19,"i",12),t.j41(20,"h4",10),t.EFF(21,"Sales Insights"),t.k0s()()(),t.j41(22,"div",7)(23,"app-card",8),t.bIt("click",function(){return t.eBV(n),t.Njj(a.openSummaryCSVModal())}),t.nrm(24,"i",13),t.j41(25,"h4",10),t.EFF(26,"Summary CSV (Customized)"),t.k0s()()()()(),t.DNE(27,M,8,2,"ng-template",null,0,t.C5r)(29,G,9,3,"ng-template",null,1,t.C5r)(31,B,11,11,"ng-template",null,2,t.C5r)(33,$,19,12,"ng-template",null,3,t.C5r)(35,X,74,17,"ng-template",null,4,t.C5r)}2&s&&(t.R7$(3),t.Y8G("hidHeader",!0),t.R7$(5),t.Y8G("hidHeader",!0),t.R7$(5),t.Y8G("hidHeader",!0),t.R7$(5),t.Y8G("hidHeader",!0),t.R7$(5),t.Y8G("hidHeader",!0))},dependencies:[D.G,c.YU,c.Sq,c.bT,d.me,d.BC,d.vS,y.i,c.oe,c.vh,p.J,p.Q],styles:[".loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#333}.loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.hr[_ngcontent-%COMP%]{border:none;height:5px;background-color:#333;width:100%;margin:10px 0}.apexcharts-canvas[_ngcontent-%COMP%]{width:100%!important;height:auto!important}.opening-header[_ngcontent-%COMP%]{background-color:#d1e7dd;text-align:center}.return-header[_ngcontent-%COMP%]{background-color:#fff7d1;text-align:center}.actual-header[_ngcontent-%COMP%]{background-color:#afb2c1;text-align:center}"]})}return i})()}}]);