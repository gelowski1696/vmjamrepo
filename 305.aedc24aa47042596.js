"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[305],{6305:(E,h,a)=>{a.r(h),a.d(h,{default:()=>C});var p=a(2389),d=a(177),e=a(3953),g=a(584),o=a(4341),u=a(3413);function _(i,c){1&i&&(e.j41(0,"div",16)(1,"div",17)(2,"p"),e.EFF(3,"Loading..."),e.k0s()()())}function m(i,c){if(1&i&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&i){const t=c.$implicit,s=e.XpG(2);e.R7$(2),e.JRh(s.formatDate(t.lenddate)),e.R7$(2),e.JRh(t.lendrefnum),e.R7$(2),e.JRh(t.lendcustname),e.R7$(2),e.JRh(t.lenditemcode),e.R7$(2),e.JRh(t.lenditemname),e.R7$(2),e.JRh(t.lendqty),e.R7$(2),e.JRh(t.returnqty),e.R7$(2),e.JRh(t.lendstatus)}}function f(i,c){if(1&i&&(e.j41(0,"div",18)(1,"table",19)(2,"thead")(3,"tr",20)(4,"th"),e.EFF(5,"Date"),e.k0s(),e.j41(6,"th"),e.EFF(7,"Reference Number"),e.k0s(),e.j41(8,"th"),e.EFF(9,"Customer Name"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Item Code"),e.k0s(),e.j41(12,"th"),e.EFF(13,"Description"),e.k0s(),e.j41(14,"th"),e.EFF(15,"Lend Quantity"),e.k0s(),e.j41(16,"th"),e.EFF(17,"Return Quantity"),e.k0s(),e.j41(18,"th"),e.EFF(19,"Remarks"),e.k0s()()(),e.j41(20,"tbody"),e.DNE(21,m,17,8,"tr",21),e.k0s()()()),2&i){const t=e.XpG();e.R7$(21),e.Y8G("ngForOf",t.displayedlend)}}function F(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",22)(1,"button",23),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goToPage(n.currentPage-1))}),e.EFF(2," Previous "),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s(),e.j41(5,"button",23),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goToPage(n.currentPage+1))}),e.EFF(6," Next "),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("disabled",1===t.currentPage),e.R7$(3),e.Lme("Page ",t.currentPage," of ",t.totalPages,""),e.R7$(),e.Y8G("disabled",t.currentPage===t.totalPages)}}let C=(()=>{class i{constructor(t,s){this.customerService=t,this.datePipe=s,this.lends=[],this.displayedlend=[],this.filteredlend=[],this.loading=!1,this.currentPage=1,this.pageSize=10,this.totalPages=1,this.searchTerm="",this.searchCriteria="lenditemcode",this.lendStatus=""}formatDate(t){return this.datePipe.transform(t,"yyyy-MM-dd")||""}ngOnInit(){this.loadLend()}loadLend(){this.loading=!0,this.customerService.getLendHistory().subscribe(t=>{this.lends=t,this.applyStatusFilter(),this.totalPages=Math.ceil(this.filteredlend.length/this.pageSize),this.updateDisplayedLend(),this.loading=!1},t=>{this.loading=!1,console.error("Error fetching Lend",t)})}applyStatusFilter(){this.filteredlend=this.lendStatus?this.lends.filter(t=>t.lendstatus===this.lendStatus):this.lends,this.totalPages=Math.ceil(this.filteredlend.length/this.pageSize),this.currentPage=1,this.updateDisplayedLend()}updateDisplayedLend(){const t=(this.currentPage-1)*this.pageSize;this.displayedlend=this.filteredlend.slice(t,t+this.pageSize)}goToPage(t){t>=1&&t<=this.totalPages&&(this.currentPage=t,this.updateDisplayedLend())}search(){this.filteredlend=this.lends.filter(t=>t[this.searchCriteria]?.toLowerCase().includes(this.searchTerm.toLowerCase())),this.totalPages=Math.ceil(this.filteredlend.length/this.pageSize),this.currentPage=1,this.updateDisplayedLend()}filterLendStatus(t){this.lendStatus=t,this.searchTerm="",this.applyStatusFilter()}static#e=this.\u0275fac=function(s){return new(s||i)(e.rXU(g.B),e.rXU(d.vh))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-lenditems"]],standalone:!0,features:[e.Jv_([d.vh]),e.aNF],decls:22,vars:6,consts:[[1,"col-xl-12"],["cardTitle","Lended Items","blockClass","table-border-style",3,"options"],[1,"search-container"],["type","text","placeholder","Search ...",1,"form-control","search-input",3,"ngModelChange","input","ngModel"],[1,"form-control","search-criteria",3,"ngModelChange","change","ngModel"],["value","lenditemcode"],["value","lenditemname"],["value","lendcustname"],[1,"card-header"],[1,"header-title"],[1,"button-group"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"],["class","loading-overlay",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"table-responsive"],[1,"table","table-styling"],[1,"table-primary"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-dark",3,"click","disabled"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"app-card",1)(2,"div",2)(3,"input",3),e.mxI("ngModelChange",function(r){return e.DH7(n.searchTerm,r)||(n.searchTerm=r),r}),e.bIt("input",function(){return n.search()}),e.k0s(),e.j41(4,"select",4),e.mxI("ngModelChange",function(r){return e.DH7(n.searchCriteria,r)||(n.searchCriteria=r),r}),e.bIt("change",function(){return n.search()}),e.j41(5,"option",5),e.EFF(6,"Item Code"),e.k0s(),e.j41(7,"option",6),e.EFF(8,"Description"),e.k0s(),e.j41(9,"option",7),e.EFF(10,"Customer"),e.k0s()()(),e.j41(11,"div",8)(12,"div",9),e.nrm(13,"h5"),e.k0s(),e.j41(14,"div",10)(15,"button",11),e.bIt("click",function(){return n.filterLendStatus("LENDED")}),e.EFF(16,"LENDED"),e.k0s(),e.j41(17,"button",12),e.bIt("click",function(){return n.filterLendStatus("RETURNED")}),e.EFF(18,"RETURNED"),e.k0s()()(),e.DNE(19,_,4,0,"div",13)(20,f,22,1,"div",14)(21,F,7,4,"div",15),e.k0s()()),2&s&&(e.R7$(),e.Y8G("options",!1),e.R7$(2),e.R50("ngModel",n.searchTerm),e.R7$(),e.R50("ngModel",n.searchCriteria),e.R7$(15),e.Y8G("ngIf",n.loading),e.R7$(),e.Y8G("ngIf",!n.loading),e.R7$(),e.Y8G("ngIf",!n.loading&&n.displayedlend.length>0))},dependencies:[p.G,d.Sq,d.bT,o.xH,o.y7,o.me,o.wz,o.BC,o.vS,u.i],styles:[".search-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s;margin-right:10px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.search-container[_ngcontent-%COMP%]   .search-criteria[_ngcontent-%COMP%]{width:150px;padding:10px;font-size:16px;border-radius:5px;border:1px solid #ccc;transition:border-color .3s}.search-container[_ngcontent-%COMP%]   .search-criteria[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#333}.loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:5px;border-bottom:1px solid #dee2e6}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}"]})}return i})()}}]);